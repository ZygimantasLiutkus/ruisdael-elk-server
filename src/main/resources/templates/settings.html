<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
        <meta charset="UTF-8">
        <title>Device Overview</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="css/navbar.css" rel="stylesheet">
        <link href="css/device-list.css" rel="stylesheet">
        <style>
            .white-text {
                color: white;
            }
        </style>
    </head>
    <body style="background-color:#2e3236">
        <div th:insert="~{navbar :: navbar}">
        </div>

        <div class="container">
            <div class="content">
                <div class="white-text">
                    <h1 style="margin-top: 2%">General Settings</h1>
                    <p>Logged in as <span sec:authentication="name"></span></p>
                    <br />
                    <h3 th:if="${param.get('unequal') != null}">Passwords do not match.</h3>
                    <h3 th:if="${param.get('wrong') != null}">Old password was incorrect.</h3>
                    <h3 th:if="${param.get('error') != null}">An unknown error occurred.</h3>
                </div>

                <form th:action="@{/change-password}" th:object="${passworddto}" method="post" id="password-form">
                    <input th:field="*{currentPassword}" type="password" placeholder="current password">
                    <br />
                    <input th:field="*{newPassword}" type="password" placeholder="new password">
                    <br />
                    <input th:field="*{confirmPassword}" type="password" placeholder="confirm password">
                </form>
                <br />
                <button type="submit" form="password-form" class="btn btn-outline-secondary"
                    style="margin-top: 10px;">Change Password</button>

                <hr />

                <div sec:authorize="hasAuthority('ADMIN')">
                    <h1 style="color: white;">User List</h1>
                    <table class="table table-dark" id="device-table">
                        <thead>
                        <tr>
                            <th><button type="button" class="btn btn-primary">Username</button></th>
                            <th><button type="button" class="btn btn-primary">Groups</button></th>
                            <th><button type="button" class="btn btn-primary">Options</button></th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr th:each="user : ${users}">
                                <td><span th:text="${user.getUsername()}">Username</span></td>
                                <td><span th:each="authority,status : ${user.getAuthorities()}" th:text="${authority.getAuthority() + (status.last ? '' : ', ')}">Group</span></td>
                                <td>
                                    Todo
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>
</html>